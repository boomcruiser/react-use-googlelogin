"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");function t(){return(t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function n(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));var r=function(e,t){var n=e.getAuthResponse();if(e.tokenObj=n,e.tokenId=n.id_token,e.accessToken=n.access_token,e.expiresAt=n.expires_at,t){var r=e.getBasicProfile();e.googleId=r.getId(),e.profileObj={googleId:r.getId(),imageUrl:r.getImageUrl(),email:r.getEmail(),name:r.getName(),givenName:r.getGivenName(),familyName:r.getFamilyName()}}};exports.useGoogleLogin=function(o){var i=o.clientId,s=o.hostedDomain,c=o.handleError,a=o.redirectUri,u=o.scope,l=void 0===u?"profile email openid":u,d=o.cookiePolicy,g=void 0===d?"single_host_origin":d,f=o.fetchBasicProfile,v=void 0===f||f,p=o.uxMode,m=void 0===p?"popup":p,h=o.persist,y=void 0===h||h;if(!i)throw new Error("clientId is required.");var I,_,b=e.useState({googleUser:void 0,auth2:void 0,isSignedIn:!1,isInitialized:!1}),k=b[0],w=b[1],O=e.useRef(void 0),P=e.useRef(void 0),S=function(){try{var e=window.gapi.auth2.getAuthInstance();return e?Promise.resolve(e.signOut()).then((function(){return e.disconnect(),!0})):Promise.resolve(!1)}catch(e){return Promise.reject(e)}},j=function(e){var n,o,i,s,c=e.isSignedIn(),a=window.gapi.auth2.getAuthInstance();c&&!e.tokenId&&r(e,v),w({auth2:a,googleUser:c?t({},e,{accessToken:null!==(n=O.current)&&void 0!==n?n:e.accessToken,expiresAt:null!==(o=P.current)&&void 0!==o?o:e.expiresAt,tokenObj:t({},e.tokenObj,{access_token:null!==(i=O.current)&&void 0!==i?i:e.tokenObj.access_token,expires_at:null!==(s=P.current)&&void 0!==s?s:e.tokenObj.expires_at})}):void 0,isSignedIn:c,isInitialized:!0})};return I="___GOOGLE_LOGIN___",_=function(){var e={client_id:i,cookie_policy:g,hosted_domain:s,fetch_basic_profile:v,ux_mode:m,redirect_uri:a,scope:l};window.gapi.load("auth2",(function(){window.gapi.auth2.init(e).then((function(e){var t=e.currentUser.get(),n=t.isSignedIn();e.currentUser.listen(j),y?(n&&r(t,v),w({googleUser:t,auth2:e,isSignedIn:n,isInitialized:!0})):S()}),(function(e){c(e)}))}))},e.useEffect((function(){var e=Boolean(document.getElementById(I));if(!e){var t=document.createElement("script");t.src="https://apis.google.com/js/api.js",t.id=I,document.body.appendChild(t),_&&(t.onload=_),e&&_&&_()}}),[]),t({},k,{signIn:function(e){try{var t=window.gapi.auth2.getAuthInstance();return Promise.resolve(n((function(){return Promise.resolve(t.signIn(e)).then((function(e){return r(e,v),e}))}),(function(e){})))}catch(e){return Promise.reject(e)}},signOut:S,grantOfflineAccess:function(e){try{var t=window.gapi.auth2.getAuthInstance();return Promise.resolve(n((function(){return Promise.resolve(t.grantOfflineAccess(e)).then((function(e){return e.code}))}),(function(e){})))}catch(e){return Promise.reject(e)}},refreshUser:function(){try{return Promise.resolve(n((function(){var e=window.gapi.auth2.getAuthInstance().currentUser.get();return Promise.resolve(null==e?void 0:e.reloadAuthResponse()).then((function(e){if(e)return O.current=e.access_token,P.current=e.expires_at,{accessToken:e.access_token,expiresAt:e.expires_at}}))}),(function(e){})))}catch(e){return Promise.reject(e)}}})};
//# sourceMappingURL=react-use-googlelogin.cjs.production.min.js.map
